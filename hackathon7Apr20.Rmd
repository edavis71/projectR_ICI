```{r}
load('pData.rdata')
load('sampleFactors_CoGAPS.rdata')
```

```{r}
library(ROCR)
library(pheatmap)
set.seed(132)
selected10k <- sample(252990,1e3)
labels <- pDat[selected10k,3]
results <- model.matrix(~labels-1)
weights <- t(sampleFactors[selected10k,])
colnames(results) <- unique(labels)
weights1 <- 20
results2 <- dim(results)[2]
i <- rep(seq_len(weights1), each = results2)
j <- rep(seq_len(results2), times = weights1)
auc_res <- vapply(seq_len(weights1 * results2), function(k) {
    performance(prediction(weights[i[k],], results[,j[k]]), measure='auc')@"y.values"[[1]]
}, numeric(1))
auc_res <- unlist(auc_res)
auc_matrix <- matrix(auc_res, nrow=weights1, ncol=results2, byrow=TRUE)
rownames(auc_matrix) = rownames(weights)
colnames(auc_matrix) = colnames(results)
pheatmap(auc_matrix)
```

